  - hosts: ansible
    become: yes  
    tasks:
      - name: Build hosts file
        lineinfile:
          dest: /etc/hosts
          regexp: '.*{{ item }}$'
          line: '{{ hostvars[item].ansible_host }} {{item}}'
          state: present
        with_items: '{{ groups["kafka"] }}'   

  - hosts: kafka
    become: yes  
    pre_tasks:
      - name: Install Java 8 (OpenJDK)
        apt:
          name: openjdk-8-jre-headless
          state: present
          update_cache: yes
        tags:
          - requirements
      - name: Build hosts file
        lineinfile:
          dest: /etc/hosts
          regexp: '.*{{ item }}$'
          line: '{{ hostvars[item].ansible_host }} {{item}}'
          state: present
        with_items: '{{ groups["kafka"] }}'          
    roles:
      - role: sleighzy.zookeeper
      - role: sleighzy.kafka
        kafka_java_heap: -Xms1G -Xmx1G
        kafka_zookeeper_connect: '192.168.50.12:2181,192.168.50.13:2181,192.168.50.14:2181'
        kafka_bootstrap_servers: '192.168.50.12:9092,192.168.50.13:9092,192.168.50.14:9092'
        kafka_consumer_bootstrap_servers: '192.168.50.12:9092,192.168.50.13:9092,192.168.50.14:9092'
        kafka_listener_hostname: ""